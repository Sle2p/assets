var O=Object.defineProperty,L=Object.defineProperties;var N=Object.getOwnPropertyDescriptors;var g=Object.getOwnPropertySymbols;var T=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable;var p=(l,r,i)=>r in l?O(l,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):l[r]=i,y=(l,r)=>{for(var i in r||(r={}))T.call(r,i)&&p(l,i,r[i]);if(g)for(var i of g(r))$.call(r,i)&&p(l,i,r[i]);return l},v=(l,r)=>L(l,N(r));import{_ as B,a as b}from"./index.77898d47.js";import{m as x,r as k,c as f,w as P,q,u,o as h,v as E,F as D,G as H,f as M,H as R}from"./@vue.86bfd1f8.js";import"./vue-router.9a8cfd5a.js";import"./vuex.418d299d.js";import"./axios.3fb31503.js";const S={props:{cube:Boolean,data:Object},emits:["load"],setup(l,{emit:r}){const i=l,z=x(()=>b(()=>import("./MasonryItem.5310df3f.js"),["assets/MasonryItem.5310df3f.js","assets/MasonryItem.899cd924.css","assets/@vue.86bfd1f8.js","assets/index.77898d47.js","assets/index.b4b37ec1.css","assets/vue-router.9a8cfd5a.js","assets/vuex.418d299d.js","assets/axios.3fb31503.js"])),A=x(()=>b(()=>import("./Empty.7d662946.js"),["assets/Empty.7d662946.js","assets/Empty.769a60d9.css","assets/index.77898d47.js","assets/index.b4b37ec1.css","assets/@vue.86bfd1f8.js","assets/vue-router.9a8cfd5a.js","assets/vuex.418d299d.js","assets/axios.3fb31503.js"])),t=k({height:0,width:0,max_width:1200,ratio:.95,size:200,margin:10,column:5,row:[],virtual:{start:null,end:null,limit:100}}),o=k({data:f(()=>(_(),Array.from(i.data||[]).map((e,d)=>{const a=(t.width-t.margin*(t.column-1))/t.column,s=e.height/e.width>5||i.cube?a:a/e.width*e.height,n=m=>m*(a+t.margin),c=()=>e.layout&&e.layout.color?e.layout.color:`#${Math.random().toString(16).slice(2,8)}`,I=()=>{if(d<t.column)return t.row[d]=s+t.margin,t.height=Math.max(...t.row),{width:Number(a.toFixed(1)),height:Number(s.toFixed(1)),left:n(d),top:0,color:c()};{const m=Math.min(...t.row),w=t.row.indexOf(m);return t.row[w]+=s+t.margin,t.height=Math.max(...t.row),{width:Number(a.toFixed(1)),height:Number(s.toFixed(1)),left:n(w),top:Number(m.toFixed(1)),color:c()}}};return v(y({},e),{layout:I()})}))),virtual:f(()=>t.virtual.start&&t.virtual.end?o.data.filter(d=>d.layout.top>t.virtual.start&&d.layout.top<t.virtual.end):o.data.slice(0,t.virtual.limit)),io:new IntersectionObserver(([e])=>{e.isIntersecting&&(r("load"),o.io.unobserve(e.target))}),masonry:null,masonry_item:null,ticking:{scroll:!1,resize:!1}}),_=()=>{t.width=document.body.offsetWidth*t.ratio>t.max_width?t.max_width:document.body.offsetWidth*t.ratio,t.column=Math.max(2,~~((t.width+t.margin)/(t.size+t.margin))),t.column!==t.row.length&&(t.row=new Array(t.column).fill(0)),o.ticking.resize=!1},F=()=>{o.ticking.scroll||window.requestAnimationFrame(()=>{var a,s,n,c;const e=((a=document==null?void 0:document.documentElement)==null?void 0:a.scrollTop)||(window==null?void 0:window.pageYOffset)||((s=document==null?void 0:document.body)==null?void 0:s.scrollTop)||0,d=(n=document==null?void 0:document.documentElement)==null?void 0:n.clientHeight;t.virtual.start=e-(d+((c=o==null?void 0:o.masonry)==null?void 0:c.offsetTop)||0),t.virtual.end=e+d*3,o.ticking.scroll=!1}),o.ticking.scroll=!0},j=()=>{o.ticking.resize||window.requestAnimationFrame(_),o.ticking.resize=!0};return P(f(()=>{var e;return(e=o==null?void 0:o.masonry_item)==null?void 0:e.$el}),(e,d)=>{var n,c;const a=(n=Array.from(o.data).pop())==null?void 0:n.id,s=(c=Array.from(o.virtual).pop())==null?void 0:c.id;a===s&&e&&o.io.observe(e)}),q(()=>{window.addEventListener("scroll",F),window.addEventListener("resize",j)}),(e,d)=>{var a,s;return((s=(a=u(o))==null?void 0:a.virtual)==null?void 0:s.length)?(h(),E("section",{masonry:"",style:R({"--width":`${u(t).width/10}rem`,"--height":`${u(t).height/10}rem`}),key:e.$route.fullPath,ref:n=>u(o).masonry=n},[(h(!0),E(D,null,H(u(o).virtual,n=>(h(),M(u(z),{data:n,key:n.id,ref:c=>u(o).masonry_item=c},null,8,["data"]))),128))],4)):(h(),M(u(A),{key:1}))}}};var K=B(S,[["__scopeId","data-v-d2aee8d8"]]);export{K as default};
